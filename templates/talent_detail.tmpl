<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>タレント詳細</title>
    <link rel="stylesheet" href="/static/css/main.css" />
</head>
<body>
    <div class="container">
        <h1>タレント詳細</h1>

        <nav class="nav">
            <a class="nav__item" href="/talents">一覧に戻る</a>
            <span class="nav__separator">|</span>
            <a class="nav__item" href="/">ホーム</a>
            <span class="nav__separator">|</span>
            <a class="nav__item" href="/logout">ログアウト</a>
        </nav>

        <div class="card">
            <div class="card__header">
                <h2 class="card__title">{{.Talent.Name}}</h2>
            </div>
            <div class="card__body">
                <p><strong>所属:</strong> {{if .Talent.Affiliation.Valid}}{{.Talent.Affiliation.String}}{{else}}-{{end}}</p>

                <div class="stat-grid">
                    <div class="stat">
                        <div class="stat__label">美しさ</div>
                        <div class="stat__value">{{.Talent.TotalBeauty}}</div>
                        <div class="stat__change u-text-muted">初期値: {{.Talent.Beauty}}</div>
                    </div>
                    <div class="stat">
                        <div class="stat__label">可愛さ</div>
                        <div class="stat__value">{{.Talent.TotalCuteness}}</div>
                        <div class="stat__change u-text-muted">初期値: {{.Talent.Cuteness}}</div>
                    </div>
                    <div class="stat">
                        <div class="stat__label">才能</div>
                        <div class="stat__value">{{.Talent.TotalTalent}}</div>
                        <div class="stat__change u-text-muted">初期値: {{.Talent.Talent}}</div>
                    </div>
                </div>
            </div>
            <div class="card__footer">
                <a class="btn btn--secondary" href="/talents/edit?id={{.Talent.ID}}">編集</a>
                <form action="/talents/delete" method="POST">
                    <input type="hidden" name="id" value="{{.Talent.ID}}">
                    <button class="btn btn--danger" type="submit" onclick="return confirm('本当に削除しますか?')">削除</button>
                </form>
            </div>
        </div>

        <h2>加点・減点を追加</h2>
        <form class="form" action="/talents/adjust" method="POST">
            <input type="hidden" name="talent_id" value="{{.Talent.ID}}">

            <div class="form__group">
                <label class="form__label" for="adjustment_type">種類</label>
                <select class="form__select" id="adjustment_type" name="adjustment_type" required>
                    <option value="beauty">美しさ</option>
                    <option value="cuteness">可愛さ</option>
                    <option value="talent">才能</option>
                </select>
            </div>

            <div class="form__group">
                <label class="form__label" for="points">点数 (-10 ~ 10)</label>
                <input class="form__input" type="number" id="points" name="points" min="-10" max="10" required>
            </div>

            <div class="form__group">
                <label class="form__label" for="reason">理由</label>
                <input class="form__input" type="text" id="reason" name="reason" required>
            </div>

            <div class="form__actions">
                <button class="btn btn--primary" type="submit">追加</button>
            </div>
        </form>

        <h2>調整履歴</h2>
        <table class="table">
            <thead class="table__header">
                <tr class="table__row">
                    <th class="table__header-cell">種類</th>
                    <th class="table__header-cell">点数</th>
                    <th class="table__header-cell">理由</th>
                    <th class="table__header-cell">日時</th>
                </tr>
            </thead>
            <tbody>
                {{range .Adjustments}}
                <tr class="table__row">
                    <td class="table__cell">
                        {{if eq .AdjustmentType "beauty"}}美しさ
                        {{else if eq .AdjustmentType "cuteness"}}可愛さ
                        {{else if eq .AdjustmentType "talent"}}才能
                        {{end}}
                    </td>
                    <td class="table__cell {{if gt .Points 0}}u-text-success{{else if lt .Points 0}}u-text-danger{{end}}">
                        {{if gt .Points 0}}+{{end}}{{.Points}}
                    </td>
                    <td class="table__cell">{{.Reason}}</td>
                    <td class="table__cell">{{.CreatedAt}}</td>
                </tr>
                {{else}}
                <tr class="table__row">
                    <td class="table__cell table__cell--empty" colspan="4">調整履歴がありません</td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
</body>
</html>
